<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title> 安全导航 | 快捷稳定 </title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  
  <!-- Tailwind配置（精简无关扩展） -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { primary: '#3B82F6', dark: '#1F2937' },
        }
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .card-hover { @apply transition-all duration-300 hover:shadow-lg hover:-translate-y-1 hover:bg-primary/5; }
      .category-title { @apply text-lg md:text-xl font-bold text-dark mb-4 pl-3 py-1 border-l-4 border-primary; }
      .site-card { @apply bg-white rounded-xl p-5 shadow-sm card-hover flex flex-col items-center text-center w-full max-w-[120px] mx-auto cursor-pointer; }
      .site-icon { @apply text-2xl md:text-3xl mb-3 transition-transform group-hover:scale-110; }
      .site-name { @apply text-sm md:text-base font-medium truncate w-full; }
    }
  </style>
</head>

<body class="bg-gray-50 font-sans">
  <!-- 顶部导航 -->
  <header class="bg-white shadow-sm sticky top-0 z-10">
    <div class="container mx-auto px-4 py-4">
      <div class="flex flex-col md:flex-row items-center justify-between gap-4">
        <div class="flex items-center space-x-3">
          <i class="fa fa-compass text-primary text-2xl"></i>
          <h1 class="text-2xl font-bold bg-gradient-to-r from-primary to-blue-400 bg-clip-text text-transparent">天空的飞鸟</h1>
        </div>
        
        <!-- 搜索框 -->
        <div class="w-full md:w-1/3">
          <div class="relative">
            <input type="text" id="searchInput" placeholder="搜索内容..." 
                  class="w-full py-2 px-4 pr-10 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-primary/30">
            <button id="searchBtn" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-primary">
              <i class="fa fa-search"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- 主要内容 -->
  <main class="container mx-auto px-4 py-8">
    <!-- 时间显示 -->
    <div class="bg-white rounded-xl p-4 mb-6 shadow-sm text-center">
      <div id="beijingDate" class="text-gray-500"></div>
      <div id="beijingTime" class="text-2xl font-bold mt-1"></div>
    </div>

    <!-- 说明 -->
    <div class="bg-white rounded-xl p-4 mb-8 shadow-sm">
      <p class="text-gray-600"><i class="fa fa-info-circle text-primary mr-2"></i>点击相应的卡片即可进入网站</p>
    </div>

    <!-- 1. 常用工具 -->
    <section class="mb-12">
      <h2 class="category-title">常用工具</h2>
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">
        <div class="site-card group" onclick="verifySite('baidu')"><i class="fa fa-search site-icon text-blue-500 group-hover:text-primary"></i><span class="site-name">百度 </span></div>
        <div class="site-card group" onclick="verifySite('google')"><i class="fa fa-google site-icon text-red-500 group-hover:text-primary"></i><span class="site-name">谷歌  </span></div>
        <div class="site-card group" onclick="verifySite('github')"><i class="fa fa-github site-icon text-gray-800 group-hover:text-primary"></i><span class="site-name">GitHub  </span></div>
        <div class="site-card group" onclick="verifySite('codepen')"><i class="fa fa-code site-icon text-pink-500 group-hover:text-primary"></i><span class="site-name">CodePen  </span></div>
      </div>
    </section>

    <!-- 2. 视频平台 -->
    <section class="mb-12">
      <h2 class="category-title">视频平台</h2>
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">
        <div class="site-card group" onclick="verifySite('bilibili')"><i class="fa fa-play-circle site-icon text-pink-600 group-hover:text-primary"></i><span class="site-name">哔哩哔哩  </span></div>
        <div class="site-card group" onclick="verifySite('youku')"><i class="fa fa-film site-icon text-red-600 group-hover:text-primary"></i><span class="site-name">优酷  </span></div>
        <div class="site-card group" onclick="verifySite('iqiyi')"><i class="fa fa-play-circle-o site-icon text-red-600 group-hover:text-primary"></i><span class="site-name">爱奇艺  </span></div>
        <div class="site-card group" onclick="verifySite('youtube')"><i class="fa fa-youtube-play site-icon text-red-600 group-hover:text-primary"></i><span class="site-name">YouTube  </span></div>
        <div class="site-card group" onclick="verifySite('tencent')"><i class="fa fa-television site-icon text-blue-600 group-hover:text-primary"></i><span class="site-name">腾讯视频  </span></div>
      </div>
    </section>

    <!-- 3. 社交网络 -->
    <section class="mb-12">
      <h2 class="category-title">社交网络</h2>
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">
        <div class="site-card group" onclick="verifySite('weixin')"><i class="fa fa-weixin site-icon text-green-500 group-hover:text-primary"></i><span class="site-name">微信  </span></div>
        <div class="site-card group" onclick="verifySite('weibo')"><i class="fa fa-weibo site-icon text-red-500 group-hover:text-primary"></i><span class="site-name">微博  </span></div>
        <div class="site-card group" onclick="verifySite('douyin')"><i class="fa fa-music site-icon text-gray-800 group-hover:text-primary"></i><span class="site-name">抖音  </span></div>
        <div class="site-card group" onclick="verifySite('kuaishou')"><i class="fa fa-play-circle site-icon text-orange-500 group-hover:text-primary"></i><span class="site-name">快手  </span></div>
      </div>
    </section>

    <!-- 4. 在线音乐 -->
    <section class="mb-12">
      <h2 class="category-title">在线音乐</h2>
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">
        <div class="site-card group" onclick="verifySite('neteaseMusic')"><i class="fa fa-music site-icon text-red-500 group-hover:text-primary"></i><span class="site-name">网易云音乐  </span></div>
        <div class="site-card group" onclick="verifySite('qqMusic')"><i class="fa fa-headphones site-icon text-green-500 group-hover:text-primary"></i><span class="site-name">QQ音乐  </span></div>
        <div class="site-card group" onclick="verifySite('kugouMusic')"><i class="fa fa-volume-up site-icon text-blue-500 group-hover:text-primary"></i><span class="site-name">酷狗音乐  </span></div>
        <div class="site-card group" onclick="verifySite('kuwoMusic')"><i class="fa fa-music site-icon text-purple-500 group-hover:text-primary"></i><span class="site-name">酷我音乐  </span></div>
        <div class="site-card group" onclick="verifySite('xiamiMusic')"><i class="fa fa-headphones site-icon text-orange-500 group-hover:text-primary"></i><span class="site-name">虾米音乐  </span></div>
        <div class="site-card group" onclick="verifySite('spotify')"><i class="fa fa-spotify site-icon text-green-600 group-hover:text-primary"></i><span class="site-name">Spotify  </span></div>
      </div>
    </section>

    <!-- 5. 邮箱平台 -->
    <section class="mb-12">
      <h2 class="category-title">邮箱平台</h2>
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">
        <div class="site-card group" onclick="verifySite('neteaseMail')"><i class="fa fa-envelope site-icon text-red-500 group-hover:text-primary"></i><span class="site-name">网易邮箱  </span></div>
        <div class="site-card group" onclick="verifySite('qqMail')"><i class="fa fa-envelope-o site-icon text-blue-500 group-hover:text-primary"></i><span class="site-name">QQ邮箱  </span></div>
        <div class="site-card group" onclick="verifySite('gmail')"><i class="fa fa-google site-icon text-red-500 group-hover:text-primary"></i><span class="site-name">Gmail  </span></div>
        <div class="site-card group" onclick="verifySite('outlook')"><i class="fa fa-windows site-icon text-blue-600 group-hover:text-primary"></i><span class="site-name">Outlook  </span></div>
        <div class="site-card group" onclick="verifySite('sinaMail')"><i class="fa fa-envelope site-icon text-orange-500 group-hover:text-primary"></i><span class="site-name">新浪邮箱  </span></div>
        <div class="site-card group" onclick="verifySite('sohuMail')"><i class="fa fa-envelope site-icon text-blue-400 group-hover:text-primary"></i><span class="site-name">搜狐邮箱  </span></div>
      </div>
    </section>

    <!-- 6. 学习平台 -->
    <section class="mb-12">
      <h2 class="category-title">学习平台</h2>
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">
        <div class="site-card group" onclick="verifySite('icourse')"><i class="fa fa-graduation-cap site-icon text-red-500 group-hover:text-primary"></i><span class="site-name">中国大学MOOC  </span></div>
        <div class="site-card group" onclick="verifySite('coursera')"><i class="fa fa-book site-icon text-blue-500 group-hover:text-primary"></i><span class="site-name">Coursera  </span></div>
        <div class="site-card group" onclick="verifySite('neteaseClass')"><i class="fa fa-leanpub site-icon text-orange-500 group-hover:text-primary"></i><span class="site-name">网易云课堂  </span></div>
        <div class="site-card group" onclick="verifySite('baijiajiangtan')"><i class="fa fa-television site-icon text-indigo-500 group-hover:text-primary"></i><span class="site-name">百家讲坛  </span></div>
      </div>
    </section>
  </main>

  <!-- 页脚 -->
  <footer class="bg-white border-t border-gray-200 py-6">
    <div class="container mx-auto px-4 text-center text-gray-500 text-sm">
      <p>© 2025 安全导航 | 技术出品</p>
    </div>
  </footer>

  <script>
    // 1. 配置常量（集中管理，避免重复定义）
    const API_VERIFY_PATH = "/api/verify";
    const FETCH_TIMEOUT = 10000; // 请求超时时间：10秒
    const SITE_CONFIG = {
      // 常用工具
      baidu: { name: "百度", defaultUrl: "https://www.baidu.com" },
      google: { name: "谷歌", defaultUrl: "https://www.google.com" },
      github: { name: "GitHub", defaultUrl: "https://www.github.com" },
      codepen: { name: "CodePen", defaultUrl: "https://codepen.io" },
      // 视频平台
      bilibili: { name: "哔哩哔哩", defaultUrl: "https://www.bilibili.com" },
      youku: { name: "优酷", defaultUrl: "https://www.youku.com" },
      iqiyi: { name: "爱奇艺", defaultUrl: "https://www.iqiyi.com" },
      youtube: { name: "YouTube", defaultUrl: "https://www.youtube.com" },
      tencent: { name: "腾讯视频", defaultUrl: "https://v.qq.com" },
      // 社交网络
      weixin: { name: "微信", defaultUrl: "https://weixin.qq.com/" },
      weibo: { name: "微博", defaultUrl: "https://weibo.com/" },
      douyin: { name: "抖音", defaultUrl: "https://www.douyin.com/" },
      kuaishou: { name: "快手", defaultUrl: "https://www.kuaishou.com/" },
      // 在线音乐
      neteaseMusic: { name: "网易云音乐", defaultUrl: "https://music.163.com" },
      qqMusic: { name: "QQ音乐", defaultUrl: "https://y.qq.com" },
      kugouMusic: { name: "酷狗音乐", defaultUrl: "https://www.kugou.com" },
      kuwoMusic: { name: "酷我音乐", defaultUrl: "https://www.kuwo.cn" },
      xiamiMusic: { name: "虾米音乐", defaultUrl: "https://www.xiami.com" },
      spotify: { name: "Spotify", defaultUrl: "https://open.spotify.com" },
      // 邮箱平台
      neteaseMail: { name: "网易邮箱", defaultUrl: "https://mail.163.com" },
      qqMail: { name: "QQ邮箱", defaultUrl: "https://mail.qq.com" },
      gmail: { name: "Gmail", defaultUrl: "https://mail.google.com" },
      outlook: { name: "Outlook", defaultUrl: "https://outlook.live.com" },
      sinaMail: { name: "新浪邮箱", defaultUrl: "https://mail.sina.com.cn" },
      sohuMail: { name: "搜狐邮箱", defaultUrl: "https://mail.sohu.com" },
      // 学习平台
      icourse: { name: "中国大学MOOC", defaultUrl: "https://www.icourse163.org/" },
      coursera: { name: "Coursera", defaultUrl: "https://www.coursera.org/" },
      neteaseClass: { name: "网易云课堂", defaultUrl: "https://study.163.com/" },
      baijiajiangtan: { name: "百家讲坛", defaultUrl: "https://tv.cctv.com/lm/bjjjt/" }
    };

    // 2. 带超时的fetch请求（避免无限pending）
    async function fetchWithTimeout(url, options = {}) {
      const controller = new AbortController();
      const timeoutId = setTimeout(() => controller.abort(), FETCH_TIMEOUT);
      try {
        const response = await fetch(url, { ...options, signal: controller.signal });
        clearTimeout(timeoutId);
        return response;
      } catch (err) {
        clearTimeout(timeoutId);
        throw err; // 抛出错误，让上层处理
      }
    }

    // 3. 密码验证核心逻辑（精简冗余判断）
    async function verifySite(siteKey) {
      const site = SITE_CONFIG[siteKey];
      if (!site) return alert("网站配置不存在");

      const userPassword = prompt(`请输入【${site.name}】的访问密码：`);
      if (!userPassword) {
        window.open(site.defaultUrl, "_blank");
        return;
      }

      try {
        const response = await fetchWithTimeout(API_VERIFY_PATH, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ siteKey, password: userPassword })
        });

        if (!response.ok) throw new Error(`服务异常（${response.status}）`);
        const { success, targetUrl } = await response.json();
        window.open(success ? targetUrl : site.defaultUrl, "_blank");
      } catch (err) {
        const errorMsg = err.name === "AbortError" ? "请求超时，请检查网络" : "验证失败，请重试";
        alert(errorMsg);
        console.error("验证错误：", err);
      }
    }

    // 4. 北京时间更新（优化日期格式化，减少重复计算）
    function updateBeijingTime() {
      const now = new Date();
      // 计算北京时间（UTC+8），避免重复运算
      const beijingTime = new Date(now.getTime() + 8 * 3600000);
      // 复用toLocale方法，减少代码量
      document.getElementById("beijingDate").textContent = beijingTime.toLocaleDateString("zh-CN", {
        year: "numeric", month: "long", day: "numeric", weekday: "long"
      });
      document.getElementById("beijingTime").textContent = beijingTime.toLocaleTimeString("zh-CN", {
        hour: "2-digit", minute: "2-digit", second: "2-digit", hour12: false
      });
    }
    updateBeijingTime();
    setInterval(updateBeijingTime, 1000);

    // 5. 搜索功能（精简事件绑定）
    const searchInput = document.getElementById("searchInput");
    const searchBtn = document.getElementById("searchBtn");
    const performSearch = () => {
      const query = searchInput.value.trim();
      if (query) window.open(`https://www.bing.com/search?q=${encodeURIComponent(query)}`);
    };
    searchBtn.addEventListener("click", performSearch);
    searchInput.addEventListener("keydown", (e) => e.key === "Enter" && performSearch());
  </script>
</body>
</html>
